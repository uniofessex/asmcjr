<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Unfolding Analysis of Rating Scale Data • asmcjr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Unfolding Analysis of Rating Scale Data">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-94XX640249"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-94XX640249');
</script><script defer data-domain="pkgdown.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">asmcjr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-get-start" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-rocket"></span> Get Start</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-get-start">
<li><a class="dropdown-item" href="../articles/installation.html">Installation</a></li>
    <li><a class="dropdown-item" href="../articles/support.html">Support</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-codes-and-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-project-diagram"></span> Codes and Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-codes-and-examples">
<li><a class="dropdown-item" href="../articles/ch2.html">Chapter 2: Analyzing Issue Scales</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Chapter 3: Similarities and Dissimilarities Data (Coming soon)</h6></li>
    <li><a class="dropdown-item" href="../articles/ch4.html">Chapter 4: Rating Scale Data (In progress)</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Chapter 5: Binary Choice Data (Coming soon)</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>Chapter 6: Bayesian Scaling Models (Coming soon)</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>Special Topics &amp; Applications (Coming soon)</h6></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> Reference</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/uniofessex/asmcjr"><span class="fa fa-github fa-lg"></span> GitHub</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Unfolding Analysis of Rating Scale Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/uniofessex/asmcjr/blob/HEAD/vignettes/ch4.Rmd" class="external-link"><code>vignettes/ch4.Rmd</code></a></small>
      <div class="d-none name"><code>ch4.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="metric-unfolding-using-the-mlsmu6-procedure">4.2 Metric Unfolding Using the MLSMU6 Procedure<a class="anchor" aria-label="anchor" href="#metric-unfolding-using-the-mlsmu6-procedure"></a>
</h2>
<div class="section level4">
<h4 id="example-1-1981-interest-group-ratings-of-us-senators-data">4.2.1 Example 1: 1981 Interest Group Ratings of US Senators
Data<a class="anchor" aria-label="anchor" href="#example-1-1981-interest-group-ratings-of-us-senators-data"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/uniofessex/asmcjr" class="external-link">asmcjr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/uniofessex/asmcjr" class="external-link">asmcjr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">interest1981</span><span class="op">)</span></span></code></pre></div>
<p>The data interest1981 are arranged such that the individuals
(Senators) are on the rows and the stimuli (the interest groups) are on
the columns. The interest group ratings themselves are stored in columns
9-38, which we assign to the matrix input.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert selected columns (9 to 38) from the dataframe to a matrix</span></span>
<span><span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">interest1981</span><span class="op">[</span>, <span class="fl">9</span><span class="op">:</span><span class="fl">38</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set a cutoff threshold for the number of non-missing values required per row</span></span>
<span><span class="va">cutoff</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="co"># Filter the rows to keep only those with at least 'cutoff' non-missing values</span></span>
<span><span class="va">input</span> <span class="op">&lt;-</span> <span class="va">input</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">input</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="va">cutoff</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Normalize the data by subtracting from 100 and dividing by 50</span></span>
<span><span class="va">input</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">100</span> <span class="op">-</span> <span class="va">input</span><span class="op">)</span> <span class="op">/</span> <span class="fl">50</span></span>
<span></span>
<span><span class="co"># Square the normalized data</span></span>
<span><span class="va">input2</span> <span class="op">&lt;-</span> <span class="va">input</span> <span class="op">*</span> <span class="va">input</span></span>
<span></span>
<span><span class="co"># Replace NA values in the squared data with the square of the mean of non-NA values</span></span>
<span><span class="va">input2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">input</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">input</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span></code></pre></div>
<p>use double-centering to get good starting values for the MLSMU6
algorithm.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inputDC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/doubleCenterRect.html">doubleCenterRect</a></span><span class="op">(</span><span class="va">input2</span><span class="op">)</span></span></code></pre></div>
<p>In order to obtain the starting coordinates for the stimuli (stims)
and individuals (inds), we perform singular value decomposition on the
double-centered matrix using the base function svd.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform Singular Value Decomposition (SVD) on the input matrix</span></span>
<span><span class="va">xsvd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="va">inputDC</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set the number of dimensions to retain</span></span>
<span><span class="va">ndim</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># Extract the first 'ndim' right singular vectors (stimuli) and left singular vectors (individuals)</span></span>
<span><span class="va">stims</span> <span class="op">&lt;-</span> <span class="va">xsvd</span><span class="op">$</span><span class="va">v</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="va">ndim</span><span class="op">]</span></span>
<span><span class="va">inds</span> <span class="op">&lt;-</span> <span class="va">xsvd</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="va">ndim</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Adjust the singular vectors by multiplying by the square root of the corresponding singular values</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">ndim</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">stims</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">stims</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">xsvd</span><span class="op">$</span><span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">inds</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">inds</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">xsvd</span><span class="op">$</span><span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><code>MLSMU6</code> converges on the result for the 1981 interest
group data in 12 iterations, reducing the sum of squared errors to
194.132 (this information is stored in the iter element of the returned
results from the mlsmu6 procedure).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mlsmu6.html">mlsmu6</a></span><span class="op">(</span>input <span class="op">=</span> <span class="va">interest1981</span><span class="op">[</span>,<span class="fl">9</span><span class="op">:</span><span class="fl">38</span><span class="op">]</span>, ndim<span class="op">=</span><span class="fl">2</span>, cutoff<span class="op">=</span><span class="fl">5</span>,</span>
<span>              id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">interest1981</span><span class="op">$</span><span class="va">party</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"D"</span>, <span class="st">"R"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">iter</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       iter  ErrorSS</span></span>
<span><span class="co">##  [7,]    7 195.5551</span></span>
<span><span class="co">##  [8,]    8 194.9194</span></span>
<span><span class="co">##  [9,]    9 194.5672</span></span>
<span><span class="co">## [10,]   10 194.3567</span></span>
<span><span class="co">## [11,]   11 194.2225</span></span>
<span><span class="co">## [12,]   12 194.1323</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ch4_files/figure-html/unnamed-chunk-6-1.png" alt="FIGURE 4.1: Metric Unfolding of 1981 Interest Group Ratings Data Using the MLSMU6 Procedure" width="700"><p class="caption">
FIGURE 4.1: Metric Unfolding of 1981 Interest Group Ratings Data Using
the MLSMU6 Procedure
</p>
</div>
<table class="table">
<thead><tr>
<th>Code</th>
<th>Interest Group Name</th>
</tr></thead>
<tbody>
<tr>
<td>ACLU</td>
<td>American Civil Liberties Union</td>
</tr>
<tr>
<td>ADA</td>
<td>Americans for Democratic Action</td>
</tr>
<tr>
<td>AFT</td>
<td>American Federation of Teachers</td>
</tr>
<tr>
<td>CC</td>
<td>Conservative Coalition (CQ)</td>
</tr>
<tr>
<td>CCAUSE</td>
<td>Common Cause</td>
</tr>
<tr>
<td>CCUS</td>
<td>Chamber of Commerce of the United States</td>
</tr>
<tr>
<td>COPE</td>
<td>Committee on Political Education AFL-CIO</td>
</tr>
<tr>
<td>LL</td>
<td>Liberty Lobby</td>
</tr>
<tr>
<td>NFIB</td>
<td>National Federation of Independent Business</td>
</tr>
<tr>
<td>NFU</td>
<td>National Farmers Union</td>
</tr>
<tr>
<td>NTU</td>
<td>National Taxpayers’ Union</td>
</tr>
<tr>
<td>RIPON</td>
<td>Ripon Society</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="metric-unfolding-using-majorization-smacof">4.3 Metric Unfolding Using Majorization (SMACOF)<a class="anchor" aria-label="anchor" href="#metric-unfolding-using-majorization-smacof"></a>
</h2>
<div class="section level4">
<h4 id="example-1-2009-european-election-study-danish-module">4.3.1 Example 1: 2009 European Election Study (Danish Module)<a class="anchor" aria-label="anchor" href="#example-1-2009-european-election-study-danish-module"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the smacof package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">smacof</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: plotrix</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: colorspace</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: e1071</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'smacof'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     transform</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the denmarkEES2009 dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">denmarkEES2009</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract columns related to voting propensity and convert them to a matrix</span></span>
<span><span class="va">input.den</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">denmarkEES2009</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"q39_p1"</span>,<span class="st">"q39_p2"</span>,<span class="st">"q39_p3"</span>,</span>
<span>                                         <span class="st">"q39_p4"</span>,<span class="st">"q39_p5"</span>,<span class="st">"q39_p6"</span>,<span class="st">"q39_p7"</span>,<span class="st">"q39_p8"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assign names to the columns, representing different political parties</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">input.den</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Social Democrats"</span>,</span>
<span>                         <span class="st">"Danish Social Liberal Party"</span>, <span class="st">"Conservative Peoples Party"</span>,</span>
<span>                         <span class="st">"Socialist Peoples Party"</span>, <span class="st">"Danish Peoples Party"</span>,</span>
<span>                         <span class="st">"Liberal Party"</span>, <span class="st">"Liberal Alliance"</span>, <span class="st">"June Movement"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Treat specific values (77, 88, 89) as missing values and replace them with NA</span></span>
<span><span class="va">input.den</span><span class="op">[</span><span class="va">input.den</span> <span class="op">==</span> <span class="fl">77</span> <span class="op">|</span> <span class="va">input.den</span> <span class="op">==</span> <span class="fl">88</span> <span class="op">|</span> <span class="va">input.den</span> <span class="op">==</span> <span class="fl">89</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="co"># Transform the voting propensity ratings into distances. The ratings are on a 0-10 scale,</span></span>
<span><span class="co"># so they are subtracted from 10 and divided by 5, resulting in distances ranging from 0 to 2.</span></span>
<span><span class="va">input.den</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">10</span> <span class="op">-</span> <span class="va">input.den</span><span class="op">)</span> <span class="op">/</span> <span class="fl">5</span></span>
<span></span>
<span><span class="co"># Set a cutoff value to filter respondents who provided at least 5 party ratings</span></span>
<span><span class="va">cutoff</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">input.den</span> <span class="op">&lt;-</span> <span class="va">input.den</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">input.den</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="va">cutoff</span>,<span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create the weight matrix with the same dimensions as input.den</span></span>
<span><span class="va">weightmat</span> <span class="op">&lt;-</span> <span class="va">input.den</span></span>
<span></span>
<span><span class="co"># Assign 1 to cells with non-missing values in input.den</span></span>
<span><span class="va">weightmat</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">input.den</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># Assign 0 to cells with missing values in input.den</span></span>
<span><span class="va">weightmat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">input.den</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Replace missing values in input.den with the mean of the non-missing values</span></span>
<span><span class="va">input.den</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">input.den</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">input.den</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">smacof</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/smacof/man/smacofRect.html" class="external-link">smacofRect</a></span><span class="op">(</span>delta<span class="op">=</span><span class="va">input.den</span>, ndim<span class="op">=</span><span class="fl">2</span>, itmax<span class="op">=</span><span class="fl">1000</span>,</span>
<span>                     weightmat<span class="op">=</span><span class="va">weightmat</span>, init<span class="op">=</span><span class="cn">NULL</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract estimated coordinates of voters and parties</span></span>
<span><span class="va">voters</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">conf.row</span></span>
<span><span class="va">parties</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">conf.col</span></span>
<span></span>
<span><span class="co"># Check if the first dimension score for the first party is positive</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">parties</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># If positive, flip the signs of the first dimension for both parties and voters</span></span>
<span>  <span class="va">parties</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="va">parties</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">voters</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="va">voters</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create data frame for voters</span></span>
<span><span class="va">voters.dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>   dim1 <span class="op">=</span> <span class="va">voters</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>   dim2 <span class="op">=</span> <span class="va">voters</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create data frame for parties</span></span>
<span><span class="va">parties.dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>   dim1 <span class="op">=</span> <span class="va">parties</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>   dim2 <span class="op">=</span> <span class="va">parties</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>   party <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">parties</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">voters.dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">dim1</span>, y<span class="op">=</span><span class="va">dim2</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">1</span>, color<span class="op">=</span><span class="st">"gray65"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">parties.dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">dim1</span>, y<span class="op">=</span><span class="va">dim2</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">parties.dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">dim1</span>, y<span class="op">=</span><span class="va">dim2</span>, label <span class="op">=</span> <span class="va">party</span><span class="op">)</span>, nudge_y<span class="op">=</span><span class="fl">.1</span>, size<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"First Dimension"</span>, y<span class="op">=</span><span class="st">"Second Dimension"</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>aspect.ratio<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g</span></span></code></pre></div>
<div class="figure">
<img src="ch4_files/figure-html/unnamed-chunk-12-1.png" alt="FIGURE 4.2: SMACOF (Majorization) Metric Unfolding of Propensity to Vote Ratings of Danish Political Parties (2009 European Election Study)" width="700"><p class="caption">
FIGURE 4.2: SMACOF (Majorization) Metric Unfolding of Propensity to Vote
Ratings of Danish Political Parties (2009 European Election Study)
</p>
</div>
<p>To understand the relationship between the Aldrich-McKelvey (AM)
estimates of the parties’ left-right positions and their scores on the
first and second dimensions obtained from a spatial analysis.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform OLS regression to model the relationship between the Aldrich-McKelvey </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">basicspace</span><span class="op">)</span></span>
<span><span class="va">AM.result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/basicspace/man/aldmck.html" class="external-link">aldmck</a></span><span class="op">(</span><span class="va">input.den</span>,polarity<span class="op">=</span><span class="fl">2</span>,</span>
<span>     missing<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">77</span>,<span class="fl">88</span>,<span class="fl">89</span><span class="op">)</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># estimates of the parties' left-right positions and their scores on the first and second dimensions</span></span>
<span><span class="va">ols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">AM.result</span><span class="op">$</span><span class="va">stimuli</span> <span class="op">~</span> <span class="va">parties</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">parties</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the coefficients, standard errors, t-values, and p-values from the regression model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/printCoefmat.html" class="external-link">printCoefmat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ols</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                 Estimate  Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">## (Intercept)   3.3217e-14  5.3634e-02  0.0000 1.000000   </span></span>
<span><span class="co">## parties[, 1]  8.3248e-01  1.3516e-01  6.1594 0.001641 **</span></span>
<span><span class="co">## parties[, 2] -1.9535e-01  8.7642e-02 -2.2289 0.076268 . </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate N1 and N2 from the regression coefficients</span></span>
<span><span class="va">N1</span> <span class="op">&lt;-</span> <span class="va">ols</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">/</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">ols</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">ols</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">N2</span> <span class="op">&lt;-</span> <span class="va">ols</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">/</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">ols</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">ols</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"N1 ="</span>, <span class="va">N1</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## N1 = 0.9735552</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"N2 ="</span>, <span class="va">N2</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## N2 = -0.2284518</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Normal vector (N1, N2) segment</span></span>
<span><span class="va">exp.factor</span> <span class="op">&lt;-</span> <span class="fl">1.1</span> </span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">exp.factor</span><span class="op">*</span><span class="op">-</span><span class="va">N1</span>, y<span class="op">=</span><span class="va">exp.factor</span><span class="op">*</span><span class="op">-</span><span class="va">N2</span>, </span>
<span>                          xend<span class="op">=</span><span class="va">exp.factor</span><span class="op">*</span><span class="va">N1</span>, yend<span class="op">=</span><span class="va">exp.factor</span><span class="op">*</span><span class="va">N2</span><span class="op">)</span>, </span>
<span>                      lty<span class="op">=</span><span class="fl">2</span>, linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="ch4_files/figure-html/unnamed-chunk-15-1.png" alt="FIGURE 4.3: SMACOF (Majorization) Metric Unfolding of Propensity to Vote Ratings of Danish Political Parties (2009 Eu- ropean Election Study) with Normal Vector of Left-Right Scores" width="700"><p class="caption">
FIGURE 4.3: SMACOF (Majorization) Metric Unfolding of Propensity to Vote
Ratings of Danish Political Parties (2009 Eu- ropean Election Study)
with Normal Vector of Left-Right Scores
</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/davidaarmstrong" class="external-link">Dave Armstrong</a>, <a href="https://www.essex.ac.uk/people/carro40801/royce-carroll" class="external-link">Royce Carroll</a>, <a href="https://www.christopherdhare.com/" class="external-link">Chris Hare</a>, <a href="https://www.essex.ac.uk/people/bakke28107/ryan-bakker" class="external-link">Ryan Bakker</a>, <a href="https://davidycliao.github.io" class="external-link">Yen-Chieh Liao</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
